{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 18, "column": 0}, "map": {"version":3,"sources":["file:///D:/AutomatedDialer/apps/frontend/src/app/dashboard/agent/components/ManualDialer.tsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from \"react\";\r\nimport \"./Dialer.css\";\r\n\r\nconst SIP_DOMAIN = \"pbx2.telxio.com.sg\";\r\n\r\nconst Dialer: React.FC = () => {\r\n  const [JsSIP, setJsSIP] = useState<any>(null);\r\n  const [username, setUsername] = useState(\"\");\r\n  const [password, setPassword] = useState(\"\");\r\n  const [isLoggedIn, setIsLoggedIn] = useState(false);\r\n  const [number, setNumber] = useState(\"\");\r\n  const [ua, setUa] = useState<any>(null);\r\n  const [session, setSession] = useState<any>(null);\r\n  const [status, setStatus] = useState(\"Waiting for login...\");\r\n  const [isRegistered, setIsRegistered] = useState(false);\r\n  const [isCalling, setIsCalling] = useState(false);\r\n\r\n  const localAudioRef = useRef<HTMLAudioElement>(null);\r\n  const remoteAudioRef = useRef<HTMLAudioElement>(null);\r\n\r\n  // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ Load JsSIP dynamically ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\r\n  useEffect(() => {\r\n    const loadJsSIP = async () => {\r\n      const module = await import(\"jssip\");\r\n      setJsSIP(module.default);\r\n    };\r\n    loadJsSIP();\r\n  }, []);\r\n\r\n  // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ LOGIN HANDLER ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\r\n  const handleLogin = async () => {\r\n    if (!username || !password) return alert(\"Enter SIP username and password\");\r\n    if (!JsSIP) return alert(\"JsSIP not yet loaded. Please wait a moment.\");\r\n\r\n    try {\r\n      const socket = new JsSIP.WebSocketInterface(`wss://${SIP_DOMAIN}:8089/ws`);\r\n      const configuration = {\r\n        sockets: [socket],\r\n        uri: `sip:${username}@${SIP_DOMAIN}`,\r\n        authorization_user: username,\r\n        password,\r\n        register: true,\r\n        display_name: username,\r\n      } as any;\r\n\r\n      const userAgent = new JsSIP.UA(configuration);\r\n      userAgent.start();\r\n\r\n      userAgent.on(\"connected\", () => setStatus(\"Connected\"));\r\n      userAgent.on(\"disconnected\", () => {\r\n        setStatus(\"Disconnected\");\r\n        setIsRegistered(false);\r\n      });\r\n      userAgent.on(\"registered\", () => {\r\n        setStatus(\"Registered ‚úÖ\");\r\n        setIsRegistered(true);\r\n        setIsLoggedIn(true);\r\n      });\r\n      userAgent.on(\"registrationFailed\", () => {\r\n        setStatus(\"Registration failed ‚ùå\");\r\n        setIsRegistered(false);\r\n      });\r\n\r\n      setUa(userAgent);\r\n    } catch (err) {\r\n      console.error(\"SIP configuration error\", err);\r\n      setStatus(\"SIP configuration error\");\r\n    }\r\n  };\r\n\r\n  // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ MAKE CALL ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\r\n  const makeCall = async () => {\r\n    if (!number) return alert(\"Enter number\");\r\n    if (!ua) return alert(\"UA not initialized\");\r\n    if (!isRegistered) return alert(\"SIP not registered yet\");\r\n\r\n    try {\r\n      const stream = await navigator.mediaDevices.getUserMedia({ audio: true });\r\n      if (localAudioRef.current) {\r\n        localAudioRef.current.srcObject = stream;\r\n      }\r\n\r\n      const callSession = ua.call(`sip:${number}@${SIP_DOMAIN}`, {\r\n        mediaConstraints: { audio: true, video: false },\r\n        mediaStream: stream,\r\n      });\r\n\r\n      callSession.connection.addEventListener(\"track\", (event: any) => {\r\n        if (remoteAudioRef.current) {\r\n          remoteAudioRef.current.srcObject = event.streams[0];\r\n        }\r\n      });\r\n\r\n      callSession.on(\"progress\", () => setStatus(\"Ringing...\"));\r\n      callSession.on(\"confirmed\", () => {\r\n        setStatus(\"In Call...\");\r\n        setIsCalling(true);\r\n      });\r\n      callSession.on(\"ended\", () => {\r\n        setStatus(\"Call Ended\");\r\n        setIsCalling(false);\r\n        setNumber(\"\");\r\n      });\r\n      callSession.on(\"failed\", () => {\r\n        setStatus(\"Call Failed ‚ùå\");\r\n        setIsCalling(false);\r\n      });\r\n\r\n      setSession(callSession);\r\n    } catch (err) {\r\n      console.error(\"Audio device error:\", err);\r\n      alert(\"Microphone access denied or unavailable.\");\r\n    }\r\n  };\r\n\r\n  // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ END CALL ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\r\n  const endCall = () => {\r\n    if (session) {\r\n      session.terminate();\r\n      setStatus(\"Call Ended\");\r\n      setIsCalling(false);\r\n    }\r\n  };\r\n\r\n  // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ LOGOUT HANDLER ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\r\n  const handleLogout = () => {\r\n    if (ua) ua.stop();\r\n    setUa(null);\r\n    setIsLoggedIn(false);\r\n    setIsRegistered(false);\r\n    setUsername(\"\");\r\n    setPassword(\"\");\r\n    setNumber(\"\");\r\n    setStatus(\"Logged out\");\r\n  };\r\n\r\n  // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ UI RENDER ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\r\n  if (!isLoggedIn) {\r\n    return (\r\n      <div className=\"login-container\">\r\n        <div className=\"login-box\">\r\n          <h2>üîê SIP Login</h2>\r\n          <input\r\n            type=\"text\"\r\n            placeholder=\"SIP Username\"\r\n            value={username}\r\n            onChange={(e) => setUsername(e.target.value)}\r\n          />\r\n          <input\r\n            type=\"password\"\r\n            placeholder=\"SIP Password\"\r\n            value={password}\r\n            onChange={(e) => setPassword(e.target.value)}\r\n          />\r\n          <button onClick={handleLogin}>Login</button>\r\n          <p className=\"status\">{status}</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"dialer-container\">\r\n      <div className=\"dialer-box\">\r\n        <div className=\"status-bar\">\r\n          <div>{status}</div>\r\n          <button className=\"logout-btn\" onClick={handleLogout}>\r\n            Logout\r\n          </button>\r\n        </div>\r\n\r\n        <input\r\n          className=\"number-display\"\r\n          type=\"text\"\r\n          value={number}\r\n          onChange={(e) => setNumber(e.target.value)}\r\n          placeholder=\"Enter number\"\r\n          disabled={isCalling}\r\n        />\r\n\r\n        {/* Number Pad */}\r\n        <div className=\"keypad\">\r\n          {[\"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"*\", \"0\", \"#\"].map(\r\n            (num) => (\r\n              <button\r\n                key={num}\r\n                onClick={() => setNumber((prev) => prev + num)}\r\n                className=\"key\"\r\n              >\r\n                {num}\r\n              </button>\r\n            )\r\n          )}\r\n        </div>\r\n\r\n        <div className=\"call-controls\">\r\n          {!isCalling ? (\r\n            <button\r\n              className=\"call-btn\"\r\n              onClick={makeCall}\r\n              disabled={!isRegistered}\r\n            >\r\n              üìû Call\r\n            </button>\r\n          ) : (\r\n            <button className=\"end-btn\" onClick={endCall}>\r\n              üî¥ End\r\n            </button>\r\n          )}\r\n        </div>\r\n      </div>\r\n\r\n      <audio ref={localAudioRef} autoPlay muted></audio>\r\n      <audio ref={remoteAudioRef} autoPlay></audio>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Dialer;\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 349, "column": 0}, "map": {"version":3,"sources":["file:///D:/AutomatedDialer/apps/frontend/src/app/dashboard/agent/dialer/manual/page.tsx"],"sourcesContent":["import React from \"react\";\r\nimport Dialer from \"../../components/ManualDialer\";\r\n\r\nconst App: React.FC = () => {\r\n  return (\r\n    <div style={{ padding: 20, fontFamily: \"sans-serif\" }}>\r\n      <h2>Telxio Web Dialer</h2>\r\n      <Dialer />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default App;\r\n"],"names":[],"mappings":";;;;;AACA;;;AAEA,MAAM,MAAgB;IACpB,qBACE,8OAAC;QAAI,OAAO;YAAE,SAAS;YAAI,YAAY;QAAa;;0BAClD,8OAAC;0BAAG;;;;;;0BACJ,8OAAC,8LAAM;;;;;;;;;;;AAGb;uCAEe","debugId":null}}]
}